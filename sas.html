/* Define a macro for reading 'Type1' files */
%macro read_type1(file_path);
    data work.data1;
        set work.data1;
        infile "&file_path" truncover;
        /* Your 'Type1' INPUT statement goes here */
        input var1 var2 var3;
    run;
%mend read_type1;

/* Define a macro for reading 'Type2' files */
%macro read_type2(file_path);
    data work.data2;
        set work.data2;
        infile "&file_path" truncover;
        /* Your 'Type2' INPUT statement goes here */
        input varA $ varB;
    run;
%mend read_type2;

/* Initialize the datasets */
data work.data1 (drop=var1 var2 var3);
    length var1 var2 var3 8;
    stop;
run;

data work.data2 (drop=varA varB);
    length varA $20 varB 8;
    stop;
run;

/* Create a dataset to store the commands for reading files */
data commands;
    set files;
    length command $300;

    if index(file_name, 'Type1') then do;
        command = cat('%read_type1(', file_path, ');');
    end;
    else if index(file_name, 'Type2') then do;
        command = cat('%read_type2(', file_path, ');');
    end;
run;

/* Execute the commands */
data _null_;
    set commands;
    call execute(command);
run;


filename dirlist pipe "du -sh /path/to/directory";
data _null_;
    infile dirlist;
    input;
    put _infile_;
run;



filename diskinfo pipe "df -h .";
data _null_;
    infile diskinfo;
    input;
    put _infile_;
run;



/* Define the command and assign it to a fileref */
filename dirlist pipe "ls /your/directory/path";

/* Create a dataset from the command output */
data dirlist;
    length filename $256;  /* Adjust the length as needed */
    infile dirlist truncover;
    input filename $char256.;  /* Adjust the informat as needed */
run;

/* Print the dataset */
proc print data=dirlist noobs;
run;

/* Clear the fileref */
filename dirlist;




/* Create a dataset to store the variable lengths */
data variable_lengths;
    length varname $32 length 8;
    retain varname length;
    
    /* Open the dataset */
    dsid = open('work.your_dataset');

    /* Loop over the variables in the dataset */
    do i = 1 to attrn(dsid, 'NVARS');
        /* Get the variable name and length */
        varname = varname(dsid, i);
        length = attrn(dsid, 'LENGTH', varname);
        output;
    end;

    /* Close the dataset */
    rc = close(dsid);
run;

/* Print the variable lengths */
proc print data=variable_lengths noobs;
    var varname length;
run;


KPI Views Design & Socialization: Successfully designed various KPI views including CUBO (sales report with customer detail), Product performance, deals management, global report, and executive report. Your efforts secured a comprehensive view of business key variables, with all stakeholders and sponsors on board.

Data Table Identification: You identified the main tables required for financial, transactional, and portfolio information data. In total, 8 tables were identified and used for designing the different types of KPI views.

Cataloguing: You contributed to cataloguing various factors like transactional types, card and customer status, types of clients, channels of payments, and interchange for domestic fees for debit and credit. These were then incorporated into the design of the KPI views.

Report Review & Rectification: A detailed review of the quarterly report shared between HSBC and VISA was conducted, leading to the detection of some issues. A resolution was then implemented to ensure accurate information in future reports. For Credit, an additional BIN was removed to align the information with estimations, and for Debit, domestic cash withdrawals were appropriately excluded to match revenue information.

Data Restoration & Integration: Successfully restored and integrated 2022 data with the current ETL flows for different views.

Automation of KPI Generation: Played a crucial role in automating KPI generation for GLOBAL and partially for CUBO reports. These automated processes are now successfully running on a monthly basis.
