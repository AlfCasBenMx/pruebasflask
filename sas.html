/* Create a dataset to store the commands for reading files */
data commands;
    set files;
    length command $300;

    if index(file_name, 'Type1') then do;
        command = catx(' ', 'data work.data1; set work.data1; infile "', file_path, '" truncover; input var1 var2 var3; run;');
    end;
    else if index(file_name, 'Type2') then do;
        command = catx(' ', 'data work.data2; set work.data2; infile "', file_path, '" truncover; input varA $ varB; run;');
    end;
run;

/* Initialize the datasets */
data work.data1 (drop=var1 var2 var3);
    length var1 var2 var3 8;
    stop;
run;

data work.data2 (drop=varA varB);
    length varA $20 varB 8;
    stop;
run;

/* Execute the commands */
data _null_;
    set commands;
    call execute(command);
run;
