data archivos;
   set carpetas;
   ruta = cats('/ruta/a/datos/', nombre);
   filename carpeta "&ruta";
   x = dir(carpeta);
   do i = 1 to countw(x);
      if upcase(scan(x, i)) ne '.' and upcase(scan(x, i)) ne '..'
      and ftype(scan(x, i)) ne 'DIRECTORY' then do;
         archivo = scan(x, i);
         output;
      end;
   end;
run;

