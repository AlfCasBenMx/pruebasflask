/* Define a macro for reading 'Type1' files */
%macro read_type1(file_path);
    data work.data1;
        set work.data1;
        infile "&file_path" truncover;
        /* Your 'Type1' INPUT statement goes here */
        input var1 var2 var3;
    run;
%mend read_type1;

/* Define a macro for reading 'Type2' files */
%macro read_type2(file_path);
    data work.data2;
        set work.data2;
        infile "&file_path" truncover;
        /* Your 'Type2' INPUT statement goes here */
        input varA $ varB;
    run;
%mend read_type2;

/* Initialize the datasets */
data work.data1 (drop=var1 var2 var3);
    length var1 var2 var3 8;
    stop;
run;

data work.data2 (drop=varA varB);
    length varA $20 varB 8;
    stop;
run;

/* Create a dataset to store the commands for reading files */
data commands;
    set files;
    length command $300;

    if index(file_name, 'Type1') then do;
        command = cat('%read_type1(', file_path, ');');
    end;
    else if index(file_name, 'Type2') then do;
        command = cat('%read_type2(', file_path, ');');
    end;
run;

/* Execute the commands */
data _null_;
    set commands;
    call execute(command);
run;


filename dirlist pipe "du -sh /path/to/directory";
data _null_;
    infile dirlist;
    input;
    put _infile_;
run;



filename diskinfo pipe "df -h .";
data _null_;
    infile diskinfo;
    input;
    put _infile_;
run;



/* Define the command and assign it to a fileref */
filename dirlist pipe "ls /your/directory/path";

/* Create a dataset from the command output */
data dirlist;
    length filename $256;  /* Adjust the length as needed */
    infile dirlist truncover;
    input filename $char256.;  /* Adjust the informat as needed */
run;

/* Print the dataset */
proc print data=dirlist noobs;
run;

/* Clear the fileref */
filename dirlist;

